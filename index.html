<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>JIMS ‚Äî JACSICE Information Management System</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=Sora:wght@600;700;800&family=IBM+Plex+Sans:wght@300;400;500;600&family=DM+Mono:wght@400;500&family=Baloo+Bhai+2:wght@400&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
  <!-- Firebase v9 compat (works without bundler) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
  <script src="script.js" defer></script>
</head>
<body>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     PAGE: LOGIN  (id="page-login")
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="page-login" class="page active">
  <div class="login-container" role="form" aria-label="Login form">
    <div class="login-logo">
      <div class="login-logo-icon">J</div>
      <span class="login-brand">JIMS</span>
    </div>
    <h2>Welcome Back</h2>
    <p class="login-sub">JACSICE Information Management System</p>

    <label for="user-type">Select Role</label>
    <select id="user-type" aria-label="Select user role">
      <option value="student">Student Login</option>
      <option value="teacher">Teacher Login</option>
      <option value="admin">Administrator Login</option>
    </select>

    <label for="username">Username</label>
    <input type="text" id="username" placeholder="Enter Username" required />

    <label for="password">Password</label>
    <input type="password" id="password" placeholder="Enter Password" required />

    <label for="captcha-input">Enter CAPTCHA</label>
    <div class="captcha-container">
      <input type="text" id="captcha" disabled aria-disabled="true" />
      <button type="button" onclick="generateCaptcha()">‚Üª Refresh</button>
    </div>
    <input type="text" id="captcha-input" placeholder="Enter CAPTCHA" required />

    <!-- OTP Section ‚Äî shown only for Student / Teacher (code is displayed in Admin Portal) -->
    <div id="otpSection" style="display:none; margin-top:14px;">
      <label style="display:flex; align-items:center; justify-content:space-between; margin-bottom:6px;">
        <span><i class="fa fa-shield-halved" style="color:#22c55e;"></i> One-Time Password (OTP)</span>
        <span style="font-size:0.75rem; color:#aaa;">Get code from Admin Portal</span>
      </label>
      <div style="background:rgba(34,197,94,0.07); border:1px solid rgba(34,197,94,0.25); border-radius:10px; padding:10px 14px; margin-bottom:8px; font-size:0.8rem; color:#86efac;">
        <i class="fa fa-circle-info"></i> Ask your administrator for the current 6-digit OTP. It refreshes every 30 seconds.
      </div>
      <input type="text" id="otp-input" placeholder="Enter 6-digit OTP from administrator" maxlength="6"
             style="letter-spacing:4px; font-family:'DM Mono',monospace; font-size:1.1rem; text-align:center;" />
    </div>

    <button class="login-btn" onclick="validateLogin()">Login ‚Üí</button>
    <button class="login-btn secondary" onclick="showAdminPortalPrompt()" style="margin-top:8px;"><i class="fa fa-shield"></i> Admin Portal</button>

    <!-- Admin Portal Password Box -->
    <div id="adminPortalBox" style="display:none; margin-top:14px; background:rgba(255,255,255,0.08); border:1px solid rgba(255,255,255,0.15); border-radius:10px; padding:16px;">
      <label style="color:#ccc; font-size:0.85rem; display:block; margin-bottom:6px;"><i class="fa fa-shield-halved" style="color:#22c55e;"></i> Admin Portal Access</label>
      <div style="display:flex; gap:8px; align-items:center;">
        <input type="password" id="adminPortalPassword" placeholder="Enter admin portal password" style="flex:1; padding:9px 12px; border-radius:8px; border:1px solid rgba(255,255,255,0.2); background:rgba(0,0,0,0.3); color:#fff; font-size:0.9rem;" onkeydown="if(event.key==='Enter') verifyAdminPortal()">
        <button type="button" onclick="verifyAdminPortal()" style="padding:9px 16px; background:#22c55e; color:#fff; border:none; border-radius:8px; cursor:pointer; font-size:0.85rem; white-space:nowrap;"><i class="fa fa-arrow-right"></i> Enter</button>
        <button type="button" onclick="document.getElementById('adminPortalBox').style.display='none'" style="padding:9px 12px; background:rgba(255,255,255,0.1); color:#ccc; border:none; border-radius:8px; cursor:pointer; font-size:0.85rem;"><i class="fa fa-xmark"></i></button>
      </div>
      <p id="adminPortalError" style="display:none; color:#f87171; font-size:0.8rem; margin-top:6px;"><i class="fa fa-circle-exclamation"></i> Incorrect password</p>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     SHARED SIDEBAR (shown on all inner pages)
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="app-shell" style="display:none; display:flex; min-height:100vh;">

  <aside id="sidebar">
    <button class="menu-btn" id="menuBtn" title="Toggle menu">
      <i class="fa fa-chevron-left"></i>
    </button>
    <a href="#" class="logo-wrapper" onclick="navigate('home'); return false;">
      <div class="logo-icon">J</div>
      <span class="brand-name">JIMS</span>
    </a>
    <p class="sidebar-section-label">Navigation</p>
    <ul class="menu-items">
      <li>
        <a href="#" class="nav-link" data-page="home">
          <span class="icon fa fa-house"></span>
          <span class="item-name">Home</span>
        </a>
        <span class="tooltip">Home</span>
      </li>
      <li>
        <a href="#" class="nav-link" data-page="dashboard">
          <span class="icon fa fa-layer-group"></span>
          <span class="item-name">Dashboard</span>
        </a>
        <span class="tooltip">Dashboard</span>
      </li>
      <li>
        <a href="#" class="nav-link" data-page="attendance">
          <span class="icon fa fa-calendar-check"></span>
          <span class="item-name">Attendance</span>
        </a>
        <span class="tooltip">Attendance</span>
      </li>
      <li>
        <a href="#" class="nav-link" data-page="profiles">
          <span class="icon fa fa-users"></span>
          <span class="item-name">Student Profile</span>
        </a>
        <span class="tooltip">Student Profile</span>
      </li>
      <li>
        <a href="#" class="nav-link" data-page="add-student">
          <span class="icon fa fa-user-plus"></span>
          <span class="item-name">Add Student</span>
        </a>
        <span class="tooltip">Add Student</span>
      </li>
    </ul>

    <div class="sidebar-footer">
      <div class="sidebar-user">
        <div class="user-avatar">A</div>
        <div class="user-info">
          <div class="user-name" id="loggedUserName">Admin</div>
          <div class="user-role" id="loggedUserRole">Administrator</div>
        </div>
      </div>
    </div>
  </aside>

  <!-- ‚îÄ‚îÄ‚îÄ MAIN WRAPPER ‚îÄ‚îÄ‚îÄ -->
  <div class="main-wrapper" id="mainWrapper">

    <!-- ‚ïê‚ïê TOP BAR ‚ïê‚ïê -->
    <header class="topbar">
      <div class="topbar-left">
        <h1 id="topbarTitle">Dashboard</h1>
        <div class="breadcrumb" id="topbarBreadcrumb">JIMS ‚Ä∫ Dashboard</div>
      </div>
      <div class="topbar-right">
        <div class="topbar-search">
          <i class="fa fa-search"></i>
          <input type="text" id="topbarSearch" placeholder="Search students‚Ä¶">
        </div>
        <button class="icon-btn" id="toggleModeBtn" title="Toggle dark mode"><i class="fa fa-moon"></i></button>
        <button class="icon-btn" onclick="doLogout()" title="Logout"><i class="fa fa-right-from-bracket"></i></button>
      </div>
    </header>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         PAGE: HOME
         ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="page-home" class="inner-page" style="display:none;">
      <div class="home-wrapper">
        <div class="home-hero">
          <div class="home-hero-text">
            <h2>Welcome to JIMS</h2>
            <p>JACSICE College of Engineering ‚Äî Department of Electronics &amp; Communication Engineering Information Management System</p>
            <p class="home-sub">Jayaraj Annapackiam CSI College of Engineering, Approved by AICTE New Delhi and Affiliated to Anna University Chennai. Accredited by NBA (ECE), Nazareth - 628617.</p>
          </div>
          <div class="home-stats-row">
            <div class="home-stat-card">
              <span class="stat-icon"><i class="fa fa-users"></i></span>
              <span class="stat-val" id="homeStatStudents">0</span>
              <span class="stat-label">Students</span>
            </div>
            <div class="home-stat-card">
              <span class="stat-icon"><i class="fa fa-calendar-check"></i></span>
              <span class="stat-val" id="homeStatAttendance">‚Äî</span>
              <span class="stat-label">Avg. Attendance</span>
            </div>
            <div class="home-stat-card">
              <span class="stat-icon"><i class="fa fa-award"></i></span>
              <span class="stat-val" id="homeStatScholar">0</span>
              <span class="stat-label">Scholarship</span>
            </div>
          </div>
        </div>

        <div class="home-content-grid">
          <div class="home-card">
            <h3><i class="fa fa-building-columns"></i> About JACSICE</h3>
            <p>JACSICE is committed to academic excellence, innovation, and social responsibility with state-of-the-art facilities in Nazareth, Tamil Nadu.</p>
            <p>UG programs: BE in CSE, ECE, Mech; B.Tech in AIDS and IT. PG programs: ME (CSE), MBA.</p>
          </div>
          <div class="home-card">
            <h3><i class="fa fa-list-check"></i> Programmes Offered</h3>
            <ul class="home-prog-list">
              <li><span class="prog-badge ug">UG</span> BE ‚Äî CSE, ECE, Mech</li>
              <li><span class="prog-badge ug">UG</span> B.Tech ‚Äî AIDS, IT</li>
              <li><span class="prog-badge pg">PG</span> ME ‚Äî CSE</li>
              <li><span class="prog-badge pg">PG</span> MBA</li>
            </ul>
          </div>
          <div class="home-card">
            <h3><i class="fa fa-bolt"></i> Quick Actions</h3>
            <div class="quick-actions">
              <a href="#" class="action-btn" onclick="navigate('attendance'); return false;"><i class="fa fa-calendar-check"></i> Take Attendance</a>
              <a href="#" class="action-btn" onclick="navigate('add-student'); return false;"><i class="fa fa-user-plus"></i> Add Student</a>
              <a href="#" class="action-btn" onclick="navigate('profiles'); return false;"><i class="fa fa-users"></i> View Profiles</a>
              <a href="#" class="action-btn" onclick="navigate('dashboard'); return false;"><i class="fa fa-chart-pie"></i> Dashboard</a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         PAGE: DASHBOARD
         ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="page-dashboard" class="inner-page" style="display:none;">
      <div class="dash-content">
        <!-- KPI Cards -->
        <div class="kpi-grid">
          <div class="kpi-card accent">
            <div class="kpi-icon"><i class="fa fa-users"></i></div>
            <div class="kpi-body">
              <div class="kpi-val" id="kpi-total">0</div>
              <div class="kpi-label">Total Students</div>
              <div class="kpi-delta" id="kpi-total-delta">‚Äî</div>
            </div>
          </div>
          <div class="kpi-card blue">
            <div class="kpi-icon"><i class="fa fa-award"></i></div>
            <div class="kpi-body">
              <div class="kpi-val" id="kpi-scholar">0</div>
              <div class="kpi-label">With Scholarship</div>
              <div class="kpi-delta" id="kpi-scholar-delta">‚Äî</div>
            </div>
          </div>
          <div class="kpi-card amber">
            <div class="kpi-icon"><i class="fa fa-layer-group"></i></div>
            <div class="kpi-body">
              <div class="kpi-val" id="kpi-departments">0</div>
              <div class="kpi-label">Departments</div>
              <div class="kpi-delta" id="dept-count-tag">‚Äî</div>
            </div>
          </div>
          <div class="kpi-card violet">
            <div class="kpi-icon"><i class="fa fa-people-group"></i></div>
            <div class="kpi-body">
              <div class="kpi-val" id="kpi-batches">0</div>
              <div class="kpi-label">Batches</div>
              <div class="kpi-delta" id="batch-count-tag">‚Äî</div>
            </div>
          </div>
        </div>

        <!-- Breakup panels -->
        <div class="panels-grid">
          <div class="panel">
            <div class="panel-header">
              <span class="panel-title">By Department</span>
            </div>
            <div id="dept-breakup" class="breakup-list"></div>
          </div>
          <div class="panel">
            <div class="panel-header">
              <span class="panel-title">By Batch</span>
            </div>
            <div id="batch-breakup" class="breakup-list"></div>
          </div>
        </div>

        <!-- Recent Students Table -->
        <div class="panel full-panel">
          <div class="panel-header">
            <span class="panel-title">Recent Students</span>
          </div>
          <div id="recent-table-wrap" class="table-scroll">
            <p style="color:var(--text-secondary); padding:16px;">No students yet. <a href="#" onclick="navigate('add-student'); return false;" style="color:var(--accent);">Add one ‚Üí</a></p>
          </div>
        </div>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         PAGE: ATTENDANCE
         ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="page-attendance" class="inner-page" style="display:none;">
      <nav class="att-nav">
        <button class="att-nav-btn active" onclick="showAttSection('homeSection')">üè† Home</button>
        <button class="att-nav-btn" onclick="showAttSection('attendanceSection')">üìä Take Attendance</button>
        <button class="att-nav-btn" onclick="showAttSection('reportsSection')">üìà Reports</button>
        <button class="att-nav-btn" onclick="showAttSection('historySection')">üìã History</button>
      </nav>

      <!-- Home sub-section -->
      <div id="homeSection" class="att-section">
        <h2>Welcome to ECE Attendance Management</h2>
        <div class="attendance-summary">
          <h3>Quick Stats</h3>
          <p>Today's Date: <strong id="currentDate"></strong></p>
          <p><strong>Critical Students (Attendance &lt; 80%)</strong> ‚Äî <span id="criticalCount">0</span></p>
          <ul id="criticalList" style="margin-top:8px; list-style:disc; padding-left:20px;">
            <li>No critical students</li>
          </ul>
        </div>
      </div>

      <!-- Take Attendance sub-section -->
      <div id="attendanceSection" class="att-section" style="display:none;">
        <h2>Take Attendance</h2>
        <div class="filter-container">
          <div>
            <label for="filterBatch">Batch (ECE):</label>
            <select id="filterBatch" onchange="loadStudents()">
              <option value="">Select Batch</option>
              <option value="ECE 2nd Year">ECE 2nd Year</option>
              <option value="ECE 3rd Year">ECE 3rd Year</option>
              <option value="ECE 4th Year">ECE 4th Year</option>
            </select>
          </div>
        </div>
        <div id="attendanceTableContainer">
          <table id="attendanceTable">
            <thead>
              <tr>
                <th>S.No</th><th>Register No.</th><th>Student Name</th><th>Department</th>
                <th>Present</th><th>Half Day</th><th>Absent</th><th>Remarks</th>
              </tr>
            </thead>
            <tbody id="attendanceTableBody">
              <tr><td colspan="8" style="text-align:center">Select batch to load students</td></tr>
            </tbody>
          </table>
        </div>
        <div class="attendance-actions">
          <button onclick="markAllPresent()">Mark All Present</button>
          <button onclick="markAllAbsent()">Mark All Absent</button>
          <button onclick="saveAttendance()">üíæ Save Attendance</button>
          <button onclick="exportToExcel()">üì• Export to Excel</button>
        </div>
      </div>

      <!-- Reports sub-section -->
      <div id="reportsSection" class="att-section" style="display:none;">
        <h2>Attendance Reports</h2>
        <div class="filter-container">
          <div>
            <label for="reportBatch">Batch (ECE):</label>
            <select id="reportBatch" onchange="generateReport()">
              <option value="">All Batches</option>
              <option value="ECE 2nd Year">ECE 2nd Year</option>
              <option value="ECE 3rd Year">ECE 3rd Year</option>
              <option value="ECE 4th Year">ECE 4th Year</option>
            </select>
          </div>
          <div>
            <label for="reportThreshold">Threshold (%):</label>
            <select id="reportThreshold" onchange="generateReport()">
              <option value="90">Below 90%</option>
              <option value="85">Below 85%</option>
              <option value="80">Below 80%</option>
            </select>
          </div>
        </div>
        <table id="reportTable">
          <thead>
            <tr><th>Register No.</th><th>Student Name</th><th>Department</th><th>Batch</th><th>Attendance %</th><th>Status</th></tr>
          </thead>
          <tbody id="reportTableBody"></tbody>
        </table>
        <div class="attendance-actions">
          <button onclick="exportReportToExcel()">üì• Download Report</button>
          <button onclick="sendAlerts()">‚ö†Ô∏è Send Alerts</button>
        </div>
      </div>

      <!-- History sub-section -->
      <div id="historySection" class="att-section" style="display:none;">
        <h2>Attendance History</h2>
        <div class="filter-container">
          <div>
            <label for="historyDate">Date:</label>
            <input type="date" id="historyDate" onchange="loadAttendanceHistory()">
          </div>
          <div>
            <label for="historyBatch">Batch (ECE):</label>
            <select id="historyBatch" onchange="loadAttendanceHistory()">
              <option value="">All Batches</option>
              <option value="ECE 2nd Year">ECE 2nd Year</option>
              <option value="ECE 3rd Year">ECE 3rd Year</option>
              <option value="ECE 4th Year">ECE 4th Year</option>
            </select>
          </div>
        </div>
        <table id="historyTable">
          <thead>
            <tr><th>Date</th><th>Register No.</th><th>Student Name</th><th>Department</th><th>Status</th><th>Remarks</th></tr>
          </thead>
          <tbody id="historyTableBody"></tbody>
        </table>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         PAGE: STUDENT PROFILES
         ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="page-profiles" class="inner-page" style="display:none;">
      <div class="profiles-toolbar">
        <div class="search-wrapper">
          <i class="fa fa-search"></i>
          <input type="text" id="searchInput" placeholder="Search by name, register no., email‚Ä¶">
   <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>JIMS ‚Äî JACSICE Information Management System</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=Sora:wght@600;700;800&family=IBM+Plex+Sans:wght@300;400;500;600&family=DM+Mono:wght@400;500&family=Baloo+Bhai+2:wght@400&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
  <!-- Firebase v9 compat (works without bundler) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
  <script src="script.js" defer></script>
</head>
<body>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     PAGE: LOGIN  (id="page-login")
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="page-login" class="page active">
  <div class="login-container" role="form" aria-label="Login form">
    <div class="login-logo">
      <div class="login-logo-icon">J</div>
      <span class="login-brand">JIMS</span>
    </div>
    <h2>Welcome Back</h2>
    <p class="login-sub">JACSICE Information Management System</p>

    <label for="user-type">Select Role</label>
    <select id="user-type" aria-label="Select user role">
      <option value="student">Student Login</option>
      <option value="teacher">Teacher Login</option>
      <option value="admin">Administrator Login</option>
    </select>

    <label for="username">Username</label>
    <input type="text" id="username" placeholder="Enter Username" required />

    <label for="password">Password</label>
    <input type="password" id="password" placeholder="Enter Password" required />

    <label for="captcha-input">Enter CAPTCHA</label>
    <div class="captcha-container">
      <input type="text" id="captcha" disabled aria-disabled="true" />
      <button type="button" onclick="generateCaptcha()">‚Üª Refresh</button>
    </div>
    <input type="text" id="captcha-input" placeholder="Enter CAPTCHA" required />

    <!-- OTP Section ‚Äî shown only for Student / Teacher (code is displayed in Admin Portal) -->
    <div id="otpSection" style="display:none; margin-top:14px;">
      <label style="display:flex; align-items:center; justify-content:space-between; margin-bottom:6px;">
        <span><i class="fa fa-shield-halved" style="color:#22c55e;"></i> One-Time Password (OTP)</span>
        <span style="font-size:0.75rem; color:#aaa;">Get code from Admin Portal</span>
      </label>
      <div style="background:rgba(34,197,94,0.07); border:1px solid rgba(34,197,94,0.25); border-radius:10px; padding:10px 14px; margin-bottom:8px; font-size:0.8rem; color:#86efac;">
        <i class="fa fa-circle-info"></i> Ask your administrator for the current 6-digit OTP. It refreshes every 30 seconds.
      </div>
      <input type="text" id="otp-input" placeholder="Enter 6-digit OTP from administrator" maxlength="6"
             style="letter-spacing:4px; font-family:'DM Mono',monospace; font-size:1.1rem; text-align:center;" />
    </div>

    <button class="login-btn" onclick="validateLogin()">Login ‚Üí</button>
    <button class="login-btn secondary" onclick="showAdminPortalPrompt()" style="margin-top:8px;"><i class="fa fa-shield"></i> Admin Portal</button>

    <!-- Admin Portal Password Box -->
    <div id="adminPortalBox" style="display:none; margin-top:14px; background:rgba(255,255,255,0.08); border:1px solid rgba(255,255,255,0.15); border-radius:10px; padding:16px;">
      <label style="color:#ccc; font-size:0.85rem; display:block; margin-bottom:6px;"><i class="fa fa-shield-halved" style="color:#22c55e;"></i> Admin Portal Access</label>
      <div style="display:flex; gap:8px; align-items:center;">
        <input type="password" id="adminPortalPassword" placeholder="Enter admin portal password" style="flex:1; padding:9px 12px; border-radius:8px; border:1px solid rgba(255,255,255,0.2); background:rgba(0,0,0,0.3); color:#fff; font-size:0.9rem;" onkeydown="if(event.key==='Enter') verifyAdminPortal()">
        <button type="button" onclick="verifyAdminPortal()" style="padding:9px 16px; background:#22c55e; color:#fff; border:none; border-radius:8px; cursor:pointer; font-size:0.85rem; white-space:nowrap;"><i class="fa fa-arrow-right"></i> Enter</button>
        <button type="button" onclick="document.getElementById('adminPortalBox').style.display='none'" style="padding:9px 12px; background:rgba(255,255,255,0.1); color:#ccc; border:none; border-radius:8px; cursor:pointer; font-size:0.85rem;"><i class="fa fa-xmark"></i></button>
      </div>
      <p id="adminPortalError" style="display:none; color:#f87171; font-size:0.8rem; margin-top:6px;"><i class="fa fa-circle-exclamation"></i> Incorrect password</p>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     SHARED SIDEBAR (shown on all inner pages)
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="app-shell" style="display:none; display:flex; min-height:100vh;">

  <aside id="sidebar">
    <button class="menu-btn" id="menuBtn" title="Toggle menu">
      <i class="fa fa-chevron-left"></i>
    </button>
    <a href="#" class="logo-wrapper" onclick="navigate('home'); return false;">
      <div class="logo-icon">J</div>
      <span class="brand-name">JIMS</span>
    </a>
    <p class="sidebar-section-label">Navigation</p>
    <ul class="menu-items">
      <li>
        <a href="#" class="nav-link" data-page="home">
          <span class="icon fa fa-house"></span>
          <span class="item-name">Home</span>
        </a>
        <span class="tooltip">Home</span>
      </li>
      <li>
        <a href="#" class="nav-link" data-page="dashboard">
          <span class="icon fa fa-layer-group"></span>
          <span class="item-name">Dashboard</span>
        </a>
        <span class="tooltip">Dashboard</span>
      </li>
      <li>
        <a href="#" class="nav-link" data-page="attendance">
          <span class="icon fa fa-calendar-check"></span>
          <span class="item-name">Attendance</span>
        </a>
        <span class="tooltip">Attendance</span>
      </li>
      <li>
        <a href="#" class="nav-link" data-page="profiles">
          <span class="icon fa fa-users"></span>
          <span class="item-name">Student Profile</span>
        </a>
        <span class="tooltip">Student Profile</span>
      </li>
      <li>
        <a href="#" class="nav-link" data-page="add-student">
          <span class="icon fa fa-user-plus"></span>
          <span class="item-name">Add Student</span>
        </a>
        <span class="tooltip">Add Student</span>
      </li>
    </ul>

    <div class="sidebar-footer">
      <div class="sidebar-user">
        <div class="user-avatar">A</div>
        <div class="user-info">
          <div class="user-name" id="loggedUserName">Admin</div>
          <div class="user-role" id="loggedUserRole">Administrator</div>
        </div>
      </div>
    </div>
  </aside>

  <!-- ‚îÄ‚îÄ‚îÄ MAIN WRAPPER ‚îÄ‚îÄ‚îÄ -->
  <div class="main-wrapper" id="mainWrapper">

    <!-- ‚ïê‚ïê TOP BAR ‚ïê‚ïê -->
    <header class="topbar">
      <div class="topbar-left">
        <h1 id="topbarTitle">Dashboard</h1>
        <div class="breadcrumb" id="topbarBreadcrumb">JIMS ‚Ä∫ Dashboard</div>
      </div>
      <div class="topbar-right">
        <div class="topbar-search">
          <i class="fa fa-search"></i>
          <input type="text" id="topbarSearch" placeholder="Search students‚Ä¶">
        </div>
        <button class="icon-btn" id="toggleModeBtn" title="Toggle dark mode"><i class="fa fa-moon"></i></button>
        <button class="icon-btn" onclick="doLogout()" title="Logout"><i class="fa fa-right-from-bracket"></i></button>
      </div>
    </header>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         PAGE: HOME
         ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="page-home" class="inner-page" style="display:none;">
      <div class="home-wrapper">
        <div class="home-hero">
          <div class="home-hero-text">
            <h2>Welcome to JIMS</h2>
            <p>JACSICE College of Engineering ‚Äî Department of Electronics &amp; Communication Engineering Information Management System</p>
            <p class="home-sub">Jayaraj Annapackiam CSI College of Engineering, Approved by AICTE New Delhi and Affiliated to Anna University Chennai. Accredited by NBA (ECE), Nazareth - 628617.</p>
          </div>
          <div class="home-stats-row">
            <div class="home-stat-card">
              <span class="stat-icon"><i class="fa fa-users"></i></span>
              <span class="stat-val" id="homeStatStudents">0</span>
              <span class="stat-label">Students</span>
            </div>
            <div class="home-stat-card">
              <span class="stat-icon"><i class="fa fa-calendar-check"></i></span>
              <span class="stat-val" id="homeStatAttendance">‚Äî</span>
              <span class="stat-label">Avg. Attendance</span>
            </div>
            <div class="home-stat-card">
              <span class="stat-icon"><i class="fa fa-award"></i></span>
              <span class="stat-val" id="homeStatScholar">0</span>
              <span class="stat-label">Scholarship</span>
            </div>
          </div>
        </div>

        <div class="home-content-grid">
          <div class="home-card">
            <h3><i class="fa fa-building-columns"></i> About JACSICE</h3>
            <p>JACSICE is committed to academic excellence, innovation, and social responsibility with state-of-the-art facilities in Nazareth, Tamil Nadu.</p>
            <p>UG programs: BE in CSE, ECE, Mech; B.Tech in AIDS and IT. PG programs: ME (CSE), MBA.</p>
          </div>
          <div class="home-card">
            <h3><i class="fa fa-list-check"></i> Programmes Offered</h3>
            <ul class="home-prog-list">
              <li><span class="prog-badge ug">UG</span> BE ‚Äî CSE, ECE, Mech</li>
              <li><span class="prog-badge ug">UG</span> B.Tech ‚Äî AIDS, IT</li>
              <li><span class="prog-badge pg">PG</span> ME ‚Äî CSE</li>
              <li><span class="prog-badge pg">PG</span> MBA</li>
            </ul>
          </div>
          <div class="home-card">
            <h3><i class="fa fa-bolt"></i> Quick Actions</h3>
            <div class="quick-actions">
              <a href="#" class="action-btn" onclick="navigate('attendance'); return false;"><i class="fa fa-calendar-check"></i> Take Attendance</a>
              <a href="#" class="action-btn" onclick="navigate('add-student'); return false;"><i class="fa fa-user-plus"></i> Add Student</a>
              <a href="#" class="action-btn" onclick="navigate('profiles'); return false;"><i class="fa fa-users"></i> View Profiles</a>
              <a href="#" class="action-btn" onclick="navigate('dashboard'); return false;"><i class="fa fa-chart-pie"></i> Dashboard</a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         PAGE: DASHBOARD
         ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="page-dashboard" class="inner-page" style="display:none;">
      <div class="dash-content">
        <!-- KPI Cards -->
        <div class="kpi-grid">
          <div class="kpi-card accent">
            <div class="kpi-icon"><i class="fa fa-users"></i></div>
            <div class="kpi-body">
              <div class="kpi-val" id="kpi-total">0</div>
              <div class="kpi-label">Total Students</div>
              <div class="kpi-delta" id="kpi-total-delta">‚Äî</div>
            </div>
          </div>
          <div class="kpi-card blue">
            <div class="kpi-icon"><i class="fa fa-award"></i></div>
            <div class="kpi-body">
              <div class="kpi-val" id="kpi-scholar">0</div>
              <div class="kpi-label">With Scholarship</div>
              <div class="kpi-delta" id="kpi-scholar-delta">‚Äî</div>
            </div>
          </div>
          <div class="kpi-card amber">
            <div class="kpi-icon"><i class="fa fa-layer-group"></i></div>
            <div class="kpi-body">
              <div class="kpi-val" id="kpi-departments">0</div>
              <div class="kpi-label">Departments</div>
              <div class="kpi-delta" id="dept-count-tag">‚Äî</div>
            </div>
          </div>
          <div class="kpi-card violet">
            <div class="kpi-icon"><i class="fa fa-people-group"></i></div>
            <div class="kpi-body">
              <div class="kpi-val" id="kpi-batches">0</div>
              <div class="kpi-label">Batches</div>
              <div class="kpi-delta" id="batch-count-tag">‚Äî</div>
            </div>
          </div>
        </div>

        <!-- Breakup panels -->
        <div class="panels-grid">
          <div class="panel">
            <div class="panel-header">
              <span class="panel-title">By Department</span>
            </div>
            <div id="dept-breakup" class="breakup-list"></div>
          </div>
          <div class="panel">
            <div class="panel-header">
              <span class="panel-title">By Batch</span>
            </div>
            <div id="batch-breakup" class="breakup-list"></div>
          </div>
        </div>

        <!-- Recent Students Table -->
        <div class="panel full-panel">
          <div class="panel-header">
            <span class="panel-title">Recent Students</span>
          </div>
          <div id="recent-table-wrap" class="table-scroll">
            <p style="color:var(--text-secondary); padding:16px;">No students yet. <a href="#" onclick="navigate('add-student'); return false;" style="color:var(--accent);">Add one ‚Üí</a></p>
          </div>
        </div>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         PAGE: ATTENDANCE
         ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="page-attendance" class="inner-page" style="display:none;">
      <nav class="att-nav">
        <button class="att-nav-btn active" onclick="showAttSection('homeSection')">üè† Home</button>
        <button class="att-nav-btn" onclick="showAttSection('attendanceSection')">üìä Take Attendance</button>
        <button class="att-nav-btn" onclick="showAttSection('reportsSection')">üìà Reports</button>
        <button class="att-nav-btn" onclick="showAttSection('historySection')">üìã History</button>
      </nav>

      <!-- Home sub-section -->
      <div id="homeSection" class="att-section">
        <h2>Welcome to ECE Attendance Management</h2>
        <div class="attendance-summary">
          <h3>Quick Stats</h3>
          <p>Today's Date: <strong id="currentDate"></strong></p>
          <p><strong>Critical Students (Attendance &lt; 80%)</strong> ‚Äî <span id="criticalCount">0</span></p>
          <ul id="criticalList" style="margin-top:8px; list-style:disc; padding-left:20px;">
            <li>No critical students</li>
          </ul>
        </div>
      </div>

      <!-- Take Attendance sub-section -->
      <div id="attendanceSection" class="att-section" style="display:none;">
        <h2>Take Attendance</h2>
        <div class="filter-container">
          <div>
            <label for="filterBatch">Batch (ECE):</label>
            <select id="filterBatch" onchange="loadStudents()">
              <option value="">Select Batch</option>
              <option value="ECE 2nd Year">ECE 2nd Year</option>
              <option value="ECE 3rd Year">ECE 3rd Year</option>
              <option value="ECE 4th Year">ECE 4th Year</option>
            </select>
          </div>
        </div>
        <div id="attendanceTableContainer">
          <table id="attendanceTable">
            <thead>
              <tr>
                <th>S.No</th><th>Register No.</th><th>Student Name</th><th>Department</th>
                <th>Present</th><th>Half Day</th><th>Absent</th><th>Remarks</th>
              </tr>
            </thead>
            <tbody id="attendanceTableBody">
              <tr><td colspan="8" style="text-align:center">Select batch to load students</td></tr>
            </tbody>
          </table>
        </div>
        <div class="attendance-actions">
          <button onclick="markAllPresent()">Mark All Present</button>
          <button onclick="markAllAbsent()">Mark All Absent</button>
          <button onclick="saveAttendance()">üíæ Save Attendance</button>
          <button onclick="exportToExcel()">üì• Export to Excel</button>
        </div>
      </div>

      <!-- Reports sub-section -->
      <div id="reportsSection" class="att-section" style="display:none;">
        <h2>Attendance Reports</h2>
        <div class="filter-container">
          <div>
            <label for="reportBatch">Batch (ECE):</label>
            <select id="reportBatch" onchange="generateReport()">
              <option value="">All Batches</option>
              <option value="ECE 2nd Year">ECE 2nd Year</option>
              <option value="ECE 3rd Year">ECE 3rd Year</option>
              <option value="ECE 4th Year">ECE 4th Year</option>
            </select>
          </div>
          <div>
            <label for="reportThreshold">Threshold (%):</label>
            <select id="reportThreshold" onchange="generateReport()">
              <option value="90">Below 90%</option>
              <option value="85">Below 85%</option>
              <option value="80">Below 80%</option>
            </select>
          </div>
        </div>
        <table id="reportTable">
          <thead>
            <tr><th>Register No.</th><th>Student Name</th><th>Department</th><th>Batch</th><th>Attendance %</th><th>Status</th></tr>
          </thead>
          <tbody id="reportTableBody"></tbody>
        </table>
        <div class="attendance-actions">
          <button onclick="exportReportToExcel()">üì• Download Report</button>
          <button onclick="sendAlerts()">‚ö†Ô∏è Send Alerts</button>
        </div>
      </div>

      <!-- History sub-section -->
      <div id="historySection" class="att-section" style="display:none;">
        <h2>Attendance History</h2>
        <div class="filter-container">
          <div>
            <label for="historyDate">Date:</label>
            <input type="date" id="historyDate" onchange="loadAttendanceHistory()">
          </div>
          <div>
            <label for="historyBatch">Batch (ECE):</label>
            <select id="historyBatch" onchange="loadAttendanceHistory()">
              <option value="">All Batches</option>
              <option value="ECE 2nd Year">ECE 2nd Year</option>
              <option value="ECE 3rd Year">ECE 3rd Year</option>
              <option value="ECE 4th Year">ECE 4th Year</option>
            </select>
          </div>
        </div>
        <table id="historyTable">
          <thead>
            <tr><th>Date</th><th>Register No.</th><th>Student Name</th><th>Department</th><th>Status</th><th>Remarks</th></tr>
          </thead>
          <tbody id="historyTableBody"></tbody>
        </table>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         PAGE: STUDENT PROFILES
         ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="page-profiles" class="inner-page" style="display:none;">
      <div class="profiles-toolbar">
        <div class="search-wrapper">
          <i class="fa fa-search"></i>
          <input type="text" id="searchInput" placeholder="Search by name, register no., email‚Ä¶">
   <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>JIMS ‚Äî JACSICE Information Management System</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=Sora:wght@600;700;800&family=IBM+Plex+Sans:wght@300;400;500;600&family=DM+Mono:wght@400;500&family=Baloo+Bhai+2:wght@400&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
  <!-- Firebase v9 compat (works without bundler) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
  <script src="script.js" defer></script>
</head>
<body>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     PAGE: LOGIN  (id="page-login")
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="page-login" class="page active">
  <div class="login-container" role="form" aria-label="Login form">
    <div class="login-logo">
      <div class="login-logo-icon">J</div>
      <span class="login-brand">JIMS</span>
    </div>
    <h2>Welcome Back</h2>
    <p class="login-sub">JACSICE Information Management System</p>

    <label for="user-type">Select Role</label>
    <select id="user-type" aria-label="Select user role">
      <option value="student">Student Login</option>
      <option value="teacher">Teacher Login</option>
      <option value="admin">Administrator Login</option>
    </select>

    <label for="username">Username</label>
    <input type="text" id="username" placeholder="Enter Username" required />

    <label for="password">Password</label>
    <input type="password" id="password" placeholder="Enter Password" required />

    <label for="captcha-input">Enter CAPTCHA</label>
    <div class="captcha-container">
      <input type="text" id="captcha" disabled aria-disabled="true" />
      <button type="button" onclick="generateCaptcha()">‚Üª Refresh</button>
    </div>
    <input type="text" id="captcha-input" placeholder="Enter CAPTCHA" required />

    <!-- OTP Section ‚Äî shown only for Student / Teacher (code is displayed in Admin Portal) -->
    <div id="otpSection" style="display:none; margin-top:14px;">
      <label style="display:flex; align-items:center; justify-content:space-between; margin-bottom:6px;">
        <span><i class="fa fa-shield-halved" style="color:#22c55e;"></i> One-Time Password (OTP)</span>
        <span style="font-size:0.75rem; color:#aaa;">Get code from Admin Portal</span>
      </label>
      <div style="background:rgba(34,197,94,0.07); border:1px solid rgba(34,197,94,0.25); border-radius:10px; padding:10px 14px; margin-bottom:8px; font-size:0.8rem; color:#86efac;">
        <i class="fa fa-circle-info"></i> Ask your administrator for the current 6-digit OTP. It refreshes every 30 seconds.
      </div>
      <input type="text" id="otp-input" placeholder="Enter 6-digit OTP from administrator" maxlength="6"
             style="letter-spacing:4px; font-family:'DM Mono',monospace; font-size:1.1rem; text-align:center;" />
    </div>

    <button class="login-btn" onclick="validateLogin()">Login ‚Üí</button>
    <button class="login-btn secondary" onclick="showAdminPortalPrompt()" style="margin-top:8px;"><i class="fa fa-shield"></i> Admin Portal</button>

    <!-- Admin Portal Password Box -->
    <div id="adminPortalBox" style="display:none; margin-top:14px; background:rgba(255,255,255,0.08); border:1px solid rgba(255,255,255,0.15); border-radius:10px; padding:16px;">
      <label style="color:#ccc; font-size:0.85rem; display:block; margin-bottom:6px;"><i class="fa fa-shield-halved" style="color:#22c55e;"></i> Admin Portal Access</label>
      <div style="display:flex; gap:8px; align-items:center;">
        <input type="password" id="adminPortalPassword" placeholder="Enter admin portal password" style="flex:1; padding:9px 12px; border-radius:8px; border:1px solid rgba(255,255,255,0.2); background:rgba(0,0,0,0.3); color:#fff; font-size:0.9rem;" onkeydown="if(event.key==='Enter') verifyAdminPortal()">
        <button type="button" onclick="verifyAdminPortal()" style="padding:9px 16px; background:#22c55e; color:#fff; border:none; border-radius:8px; cursor:pointer; font-size:0.85rem; white-space:nowrap;"><i class="fa fa-arrow-right"></i> Enter</button>
        <button type="button" onclick="document.getElementById('adminPortalBox').style.display='none'" style="padding:9px 12px; background:rgba(255,255,255,0.1); color:#ccc; border:none; border-radius:8px; cursor:pointer; font-size:0.85rem;"><i class="fa fa-xmark"></i></button>
      </div>
      <p id="adminPortalError" style="display:none; color:#f87171; font-size:0.8rem; margin-top:6px;"><i class="fa fa-circle-exclamation"></i> Incorrect password</p>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     SHARED SIDEBAR (shown on all inner pages)
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="app-shell" style="display:none; display:flex; min-height:100vh;">

  <aside id="sidebar">
    <button class="menu-btn" id="menuBtn" title="Toggle menu">
      <i class="fa fa-chevron-left"></i>
    </button>
    <a href="#" class="logo-wrapper" onclick="navigate('home'); return false;">
      <div class="logo-icon">J</div>
      <span class="brand-name">JIMS</span>
    </a>
    <p class="sidebar-section-label">Navigation</p>
    <ul class="menu-items">
      <li>
        <a href="#" class="nav-link" data-page="home">
          <span class="icon fa fa-house"></span>
          <span class="item-name">Home</span>
        </a>
        <span class="tooltip">Home</span>
      </li>
      <li>
        <a href="#" class="nav-link" data-page="dashboard">
          <span class="icon fa fa-layer-group"></span>
          <span class="item-name">Dashboard</span>
        </a>
        <span class="tooltip">Dashboard</span>
      </li>
      <li>
        <a href="#" class="nav-link" data-page="attendance">
          <span class="icon fa fa-calendar-check"></span>
          <span class="item-name">Attendance</span>
        </a>
        <span class="tooltip">Attendance</span>
      </li>
      <li>
        <a href="#" class="nav-link" data-page="profiles">
          <span class="icon fa fa-users"></span>
          <span class="item-name">Student Profile</span>
        </a>
        <span class="tooltip">Student Profile</span>
      </li>
      <li>
        <a href="#" class="nav-link" data-page="add-student">
          <span class="icon fa fa-user-plus"></span>
          <span class="item-name">Add Student</span>
        </a>
        <span class="tooltip">Add Student</span>
      </li>
    </ul>

    <div class="sidebar-footer">
      <div class="sidebar-user">
        <div class="user-avatar">A</div>
        <div class="user-info">
          <div class="user-name" id="loggedUserName">Admin</div>
          <div class="user-role" id="loggedUserRole">Administrator</div>
        </div>
      </div>
    </div>
  </aside>

  <!-- ‚îÄ‚îÄ‚îÄ MAIN WRAPPER ‚îÄ‚îÄ‚îÄ -->
  <div class="main-wrapper" id="mainWrapper">

    <!-- ‚ïê‚ïê TOP BAR ‚ïê‚ïê -->
    <header class="topbar">
      <div class="topbar-left">
        <h1 id="topbarTitle">Dashboard</h1>
        <div class="breadcrumb" id="topbarBreadcrumb">JIMS ‚Ä∫ Dashboard</div>
      </div>
      <div class="topbar-right">
        <div class="topbar-search">
          <i class="fa fa-search"></i>
          <input type="text" id="topbarSearch" placeholder="Search students‚Ä¶">
        </div>
        <button class="icon-btn" id="toggleModeBtn" title="Toggle dark mode"><i class="fa fa-moon"></i></button>
        <button class="icon-btn" onclick="doLogout()" title="Logout"><i class="fa fa-right-from-bracket"></i></button>
      </div>
    </header>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         PAGE: HOME
         ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="page-home" class="inner-page" style="display:none;">
      <div class="home-wrapper">
        <div class="home-hero">
          <div class="home-hero-text">
            <h2>Welcome to JIMS</h2>
            <p>JACSICE College of Engineering ‚Äî Department of Electronics &amp; Communication Engineering Information Management System</p>
            <p class="home-sub">Jayaraj Annapackiam CSI College of Engineering, Approved by AICTE New Delhi and Affiliated to Anna University Chennai. Accredited by NBA (ECE), Nazareth - 628617.</p>
          </div>
          <div class="home-stats-row">
            <div class="home-stat-card">
              <span class="stat-icon"><i class="fa fa-users"></i></span>
              <span class="stat-val" id="homeStatStudents">0</span>
              <span class="stat-label">Students</span>
            </div>
            <div class="home-stat-card">
              <span class="stat-icon"><i class="fa fa-calendar-check"></i></span>
              <span class="stat-val" id="homeStatAttendance">‚Äî</span>
              <span class="stat-label">Avg. Attendance</span>
            </div>
            <div class="home-stat-card">
              <span class="stat-icon"><i class="fa fa-award"></i></span>
              <span class="stat-val" id="homeStatScholar">0</span>
              <span class="stat-label">Scholarship</span>
            </div>
          </div>
        </div>

        <div class="home-content-grid">
          <div class="home-card">
            <h3><i class="fa fa-building-columns"></i> About JACSICE</h3>
            <p>JACSICE is committed to academic excellence, innovation, and social responsibility with state-of-the-art facilities in Nazareth, Tamil Nadu.</p>
            <p>UG programs: BE in CSE, ECE, Mech; B.Tech in AIDS and IT. PG programs: ME (CSE), MBA.</p>
          </div>
          <div class="home-card">
            <h3><i class="fa fa-list-check"></i> Programmes Offered</h3>
            <ul class="home-prog-list">
              <li><span class="prog-badge ug">UG</span> BE ‚Äî CSE, ECE, Mech</li>
              <li><span class="prog-badge ug">UG</span> B.Tech ‚Äî AIDS, IT</li>
              <li><span class="prog-badge pg">PG</span> ME ‚Äî CSE</li>
              <li><span class="prog-badge pg">PG</span> MBA</li>
            </ul>
          </div>
          <div class="home-card">
            <h3><i class="fa fa-bolt"></i> Quick Actions</h3>
            <div class="quick-actions">
              <a href="#" class="action-btn" onclick="navigate('attendance'); return false;"><i class="fa fa-calendar-check"></i> Take Attendance</a>
              <a href="#" class="action-btn" onclick="navigate('add-student'); return false;"><i class="fa fa-user-plus"></i> Add Student</a>
              <a href="#" class="action-btn" onclick="navigate('profiles'); return false;"><i class="fa fa-users"></i> View Profiles</a>
              <a href="#" class="action-btn" onclick="navigate('dashboard'); return false;"><i class="fa fa-chart-pie"></i> Dashboard</a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         PAGE: DASHBOARD
         ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="page-dashboard" class="inner-page" style="display:none;">
      <div class="dash-content">
        <!-- KPI Cards -->
        <div class="kpi-grid">
          <div class="kpi-card accent">
            <div class="kpi-icon"><i class="fa fa-users"></i></div>
            <div class="kpi-body">
              <div class="kpi-val" id="kpi-total">0</div>
              <div class="kpi-label">Total Students</div>
              <div class="kpi-delta" id="kpi-total-delta">‚Äî</div>
            </div>
          </div>
          <div class="kpi-card blue">
            <div class="kpi-icon"><i class="fa fa-award"></i></div>
            <div class="kpi-body">
              <div class="kpi-val" id="kpi-scholar">0</div>
              <div class="kpi-label">With Scholarship</div>
              <div class="kpi-delta" id="kpi-scholar-delta">‚Äî</div>
            </div>
          </div>
          <div class="kpi-card amber">
            <div class="kpi-icon"><i class="fa fa-layer-group"></i></div>
            <div class="kpi-body">
              <div class="kpi-val" id="kpi-departments">0</div>
              <div class="kpi-label">Departments</div>
              <div class="kpi-delta" id="dept-count-tag">‚Äî</div>
            </div>
          </div>
          <div class="kpi-card violet">
            <div class="kpi-icon"><i class="fa fa-people-group"></i></div>
            <div class="kpi-body">
              <div class="kpi-val" id="kpi-batches">0</div>
              <div class="kpi-label">Batches</div>
              <div class="kpi-delta" id="batch-count-tag">‚Äî</div>
            </div>
          </div>
        </div>

        <!-- Breakup panels -->
        <div class="panels-grid">
          <div class="panel">
            <div class="panel-header">
              <span class="panel-title">By Department</span>
            </div>
            <div id="dept-breakup" class="breakup-list"></div>
          </div>
          <div class="panel">
            <div class="panel-header">
              <span class="panel-title">By Batch</span>
            </div>
            <div id="batch-breakup" class="breakup-list"></div>
          </div>
        </div>

        <!-- Recent Students Table -->
        <div class="panel full-panel">
          <div class="panel-header">
            <span class="panel-title">Recent Students</span>
          </div>
          <div id="recent-table-wrap" class="table-scroll">
            <p style="color:var(--text-secondary); padding:16px;">No students yet. <a href="#" onclick="navigate('add-student'); return false;" style="color:var(--accent);">Add one ‚Üí</a></p>
          </div>
        </div>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         PAGE: ATTENDANCE
         ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="page-attendance" class="inner-page" style="display:none;">
      <nav class="att-nav">
        <button class="att-nav-btn active" onclick="showAttSection('homeSection')">üè† Home</button>
        <button class="att-nav-btn" onclick="showAttSection('attendanceSection')">üìä Take Attendance</button>
        <button class="att-nav-btn" onclick="showAttSection('reportsSection')">üìà Reports</button>
        <button class="att-nav-btn" onclick="showAttSection('historySection')">üìã History</button>
      </nav>

      <!-- Home sub-section -->
      <div id="homeSection" class="att-section">
        <h2>Welcome to ECE Attendance Management</h2>
        <div class="attendance-summary">
          <h3>Quick Stats</h3>
          <p>Today's Date: <strong id="currentDate"></strong></p>
          <p><strong>Critical Students (Attendance &lt; 80%)</strong> ‚Äî <span id="criticalCount">0</span></p>
          <ul id="criticalList" style="margin-top:8px; list-style:disc; padding-left:20px;">
            <li>No critical students</li>
          </ul>
        </div>
      </div>

      <!-- Take Attendance sub-section -->
      <div id="attendanceSection" class="att-section" style="display:none;">
        <h2>Take Attendance</h2>
        <div class="filter-container">
          <div>
            <label for="filterBatch">Batch (ECE):</label>
            <select id="filterBatch" onchange="loadStudents()">
              <option value="">Select Batch</option>
              <option value="ECE 2nd Year">ECE 2nd Year</option>
              <option value="ECE 3rd Year">ECE 3rd Year</option>
              <option value="ECE 4th Year">ECE 4th Year</option>
            </select>
          </div>
        </div>
        <div id="attendanceTableContainer">
          <table id="attendanceTable">
            <thead>
              <tr>
                <th>S.No</th><th>Register No.</th><th>Student Name</th><th>Department</th>
                <th>Present</th><th>Half Day</th><th>Absent</th><th>Remarks</th>
              </tr>
            </thead>
            <tbody id="attendanceTableBody">
              <tr><td colspan="8" style="text-align:center">Select batch to load students</td></tr>
            </tbody>
          </table>
        </div>
        <div class="attendance-actions">
          <button onclick="markAllPresent()">Mark All Present</button>
          <button onclick="markAllAbsent()">Mark All Absent</button>
          <button onclick="saveAttendance()">üíæ Save Attendance</button>
          <button onclick="exportToExcel()">üì• Export to Excel</button>
        </div>
      </div>

      <!-- Reports sub-section -->
      <div id="reportsSection" class="att-section" style="display:none;">
        <h2>Attendance Reports</h2>
        <div class="filter-container">
          <div>
            <label for="reportBatch">Batch (ECE):</label>
            <select id="reportBatch" onchange="generateReport()">
              <option value="">All Batches</option>
              <option value="ECE 2nd Year">ECE 2nd Year</option>
              <option value="ECE 3rd Year">ECE 3rd Year</option>
              <option value="ECE 4th Year">ECE 4th Year</option>
            </select>
          </div>
          <div>
            <label for="reportThreshold">Threshold (%):</label>
            <select id="reportThreshold" onchange="generateReport()">
              <option value="90">Below 90%</option>
              <option value="85">Below 85%</option>
              <option value="80">Below 80%</option>
            </select>
          </div>
        </div>
        <table id="reportTable">
          <thead>
            <tr><th>Register No.</th><th>Student Name</th><th>Department</th><th>Batch</th><th>Attendance %</th><th>Status</th></tr>
          </thead>
          <tbody id="reportTableBody"></tbody>
        </table>
        <div class="attendance-actions">
          <button onclick="exportReportToExcel()">üì• Download Report</button>
          <button onclick="sendAlerts()">‚ö†Ô∏è Send Alerts</button>
        </div>
      </div>

      <!-- History sub-section -->
      <div id="historySection" class="att-section" style="display:none;">
        <h2>Attendance History</h2>
        <div class="filter-container">
          <div>
            <label for="historyDate">Date:</label>
            <input type="date" id="historyDate" onchange="loadAttendanceHistory()">
          </div>
          <div>
            <label for="historyBatch">Batch (ECE):</label>
            <select id="historyBatch" onchange="loadAttendanceHistory()">
              <option value="">All Batches</option>
              <option value="ECE 2nd Year">ECE 2nd Year</option>
              <option value="ECE 3rd Year">ECE 3rd Year</option>
              <option value="ECE 4th Year">ECE 4th Year</option>
            </select>
          </div>
        </div>
        <table id="historyTable">
          <thead>
            <tr><th>Date</th><th>Register No.</th><th>Student Name</th><th>Department</th><th>Status</th><th>Remarks</th></tr>
          </thead>
          <tbody id="historyTableBody"></tbody>
        </table>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         PAGE: STUDENT PROFILES
         ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="page-profiles" class="inner-page" style="display:none;">
      <div class="profiles-toolbar">
        <div class="search-wrapper">
          <i class="fa fa-search"></i>
          <input type="text" id="searchInput" placeholder="Search by name, register no., email‚Ä¶">
   
